<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.5">
<title data-react-helmet="true">EVM vs WASM Smart Contracts | OpenBrush</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.openbrush.io/evm-wasm-smart-contracts"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="EVM vs WASM Smart Contracts | OpenBrush"><meta data-react-helmet="true" name="description" content="This short article describes differences between EVM Smart Contracts &amp; Substrate WASM Smart contracts."><meta data-react-helmet="true" property="og:description" content="This short article describes differences between EVM Smart Contracts &amp; Substrate WASM Smart contracts."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.svg"><link data-react-helmet="true" rel="canonical" href="https://docs.openbrush.io/evm-wasm-smart-contracts"><link data-react-helmet="true" rel="alternate" href="https://docs.openbrush.io/evm-wasm-smart-contracts" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.openbrush.io/evm-wasm-smart-contracts" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.3900dd10.css">
<link rel="preload" href="/assets/js/runtime~main.f123e9f3.js" as="script">
<link rel="preload" href="/assets/js/main.4e627a49.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="OpenBrush" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/logo-dark.svg" alt="OpenBrush" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/smart-contracts/overview">Examples</a><a class="navbar__item navbar__link" href="/deployment">Deploy</a><a href="https://twitter.com/supercolony_net" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-twitter-link"></a><a href="https://github.com/Supercolony-net/openbrush-contracts" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class="react-toggle toggle_2i4l react-toggle--checked react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" checked="" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button class="clean-btn backToTopButton_i9tI" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/">Getting started</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#">Smart Contracts</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/smart-contracts/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/smart-contracts/access-control">Access Control</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/smart-contracts/ownable">Ownable</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/smart-contracts/reentrancy-guard">Reentrancy Guard</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/smart-contracts/pausable">Pausable</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/smart-contracts/payment-splitter">Payment Splitter</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/smart-contracts/timelock-controller">Timelock Controller</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#" tabindex="0">PSP22</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/smart-contracts/PSP22/psp22">PSP22</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Extensions</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Utils</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#" tabindex="0">PSP34</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/smart-contracts/PSP34/psp34">PSP34</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Extensions</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#" tabindex="0">PSP1155</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/smart-contracts/PSP1155/psp1155">PSP1155</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Extensions</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#" tabindex="0">OpenBrush Example</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/smart-contracts/example/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/smart-contracts/example/setup_project">Setup the project</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/smart-contracts/example/psp22">Implement PSP-22 contract</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/smart-contracts/example/shares">Shares contract</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/smart-contracts/example/loan">Loan contract</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/smart-contracts/example/data">Data and derive macro</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/smart-contracts/example/impls">Lending impls</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/smart-contracts/example/errors">Errors</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/smart-contracts/example/contract">Lending contract</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/smart-contracts/example/implementation">Notes about methods</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/deployment">Deploy</a></li><li class="menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/evm-wasm-smart-contracts">EVM vs WASM Smart Contracts</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="markdown"><header><h1>EVM vs WASM Smart Contracts</h1></header><p>This short article describes differences between EVM Smart Contracts &amp; Substrate WASM Smart contracts.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="evm"></a>EVM<a class="hash-link" href="#evm" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="background"></a>Background<a class="hash-link" href="#background" title="Direct link to heading">#</a></h3><p>Ethereum was the first Turing-complete blockchain and was mainly developed because of limitations of Bitcoin&#x27;s script. In order to execute smart contracts, a sandbox environment is needed. The sandbox environment where Smart contracts are executed in Ethereum is the  <strong>Ethereum virtual machine</strong> (<em>EVM</em>)</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="bytecode"></a>Bytecode<a class="hash-link" href="#bytecode" title="Direct link to heading">#</a></h3><p>EVM uses a stack-based bytecode language called EVM bytecode. EVM bytecode is a series of OP_CODEs (instructions) that are executed by the EVM. These OP_CODEs offer rather limited instructions compared to a full-blown language (Java, WASM, ..)</p><p>The primitive of the bytecode is <em>256-bit</em> integer, which can be a big limitation, as it is needed to use <em>256-bit</em> integers to do calculations on even small numbers. Moreover, it will take 256 bits of memory for any value that is stored in persistent storage.</p><p>The main OP_CODEs are <strong>SLOAD</strong> to load data, <strong>SSTORE</strong> to write a <em>256-bit</em> integer to storage and <strong>CALL</strong> to call another contract <a href="https://github.com/crytic/evm-opcodes" target="_blank" rel="noopener noreferrer">full list of OP_CODES</a>. It&#x27;s via these instructions that EVMs interact with the chain.</p><p><img alt="image info" src="/assets/images/eth-1-ad987c237ade36ced07edf738d54f0f8.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="gas-model"></a>Gas model<a class="hash-link" href="#gas-model" title="Direct link to heading">#</a></h3><p>The incentive model of interacting with EVM is gas. It acts like a fee that is calculated for each instruction someone executes. Every instruction has a certain pre-calculated fee amount, and the total gas spent is the sum of all the instructions that were executed.</p><p>Please check the entire table of <a href="https://blockgeeks.com/wp-content/uploads/2018/03/image2-2.png" target="_blank" rel="noopener noreferrer">fees</a>
A gas fee is only due when interacting with EVM. There is no charge for the space you are using for storage, and it results in having a ton of dead code (or non-used contracts) stay on Ethereum chain forever.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="evm-process"></a>Evm process<a class="hash-link" href="#evm-process" title="Direct link to heading">#</a></h3><p><img alt="image info" src="/assets/images/eth2-ffa3287e02b17629ea23aeba96d201e0.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="substrate-contract-pallet"></a>Substrate Contract-Pallet<a class="hash-link" href="#substrate-contract-pallet" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="intro"></a>Intro<a class="hash-link" href="#intro" title="Direct link to heading">#</a></h3><p><code>pallet-contract</code> is a module in Substrate (the framework to build blockchain on <code>Polkadot</code>). Its purpose is a sandbox environment, which provides WASM interpreter and allows executing WASM smart contracts.</p><p><img alt="image info" src="/assets/images/WASM1-6756d42cebd1ac99b3ba95e855d30b3f.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="wasm-interpreter"></a>WASM interpreter<a class="hash-link" href="#wasm-interpreter" title="Direct link to heading">#</a></h3><p>At the moment, contract pallet uses <a href="https://github.com/paritytech/wasmi" target="_blank" rel="noopener noreferrer">wasmi</a> as the interpreter. Wasmi is a pure interpreter-type WASM virtual machine. It is used because execution of smart contract needs a high degree of correctness.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="storage-rent--gas"></a>Storage rent &amp; Gas<a class="hash-link" href="#storage-rent--gas" title="Direct link to heading">#</a></h3><p>In order to incentive the deletion of unused code on chain, pallet-contract implemented a storage-rent principle.  </p><p>Every smart contract will have a rent to pay for its code and on-chain storage (small amount at every block). When the smart contract fails to pay the rent, the contract will become a Tombstone (its storage will be deleted).</p><p>The gas system of ethereum (price depending on the complexity of the computation) is still present in Substrate, but the gas is charged after the call is executed, as it is basically a fee on the time of execution (the more time it takes for the node to execute a call, the more caller will pay). The <code>pallet-contract</code> defines the <a href="https://substrate.dev/docs/en/knowledgebase/smart-contracts/contracts-pallet" target="_blank" rel="noopener noreferrer">amount of gas</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="contract-code--instance-are-decoupled"></a>Contract code &amp; instance are decoupled<a class="hash-link" href="#contract-code--instance-are-decoupled" title="Direct link to heading">#</a></h3><p>Even though <code>pallet-contract</code> uses an account model for its contracts (like ethereum does), there is still one big difference:</p><p>When you deploy a WASM smart contract, it will only create a hash of the WASM code, meaning that this contract will have no address, nor will it have some associated storage (so it is impossible to interact with this contract). In Ethereum, though, every contract code deployed on chain has a unique address (instance) and its associated storage.</p><p>After the WASM hash is deployed, one can create as many instances of this contract as they want. Each instance will have a unique address to interact with, as well as its own associated storage.</p><p>Why is it useful:</p><ul><li>Different contract instances with different <strong>constructor parameters</strong> can be instantiated using the same uploaded code, which reduces the space needed on chain to store WASM code</li><li>Storage and balance are decoupled from contract code logic, which provides ability <strong>patch or upgrade</strong> the underlying contract code</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="evm-vs-contract-pallet"></a>EVM vs contract-pallet<a class="hash-link" href="#evm-vs-contract-pallet" title="Direct link to heading">#</a></h2><ul><li>Common point: they both are a sandbox to execute smart contracts</li><li>The engine which executes contracts is different. In Ethereum, as it was the first blockchain to implement a sandbox environment, it is rather limited and slow, compared to a wasm interpreter
Storage rent has been introduced in contract-pallet to incentivize the deletion of unused code</li><li>Contract pallet integrates a <a href="https://substrate.dev/docs/en/knowledgebase/smart-contracts/contracts-pallet#two-step-deployment" target="_blank" rel="noopener noreferrer">two-step-deployment</a> to decouple contract code and contract instances</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="comparing-wasm-smart-contracts-to-evm-smart-contracts"></a>Comparing WASM Smart contracts to EVM smart contracts<a class="hash-link" href="#comparing-wasm-smart-contracts-to-evm-smart-contracts" title="Direct link to heading">#</a></h2><ul><li>WASM is broadly adopted, while EVM bytecode is only used in EVMs -&gt; There is way more tools available for WASM development</li><li>EVM bytecode can only be compiled from Solidity or Vyper, while WASM can be compiled from a lot of Popular languages (Rust, C/C++, C#, Java, Typescript, Haxe, Kotlin and even from Solidity)</li><li>Excellent integration of Rust to compile in WASM</li><li>Lightweight: it produces lightweight binaries that can ship easily</li><li>performance near native code (2x faster than Javascipt)</li><li>Continually developed by major companies such as Google, Apple, Microsoft, Mozilla, and Facebook.</li></ul><p><a href="https://paritytech.github.io/ink-docs/why-webassembly-for-smart-contracts" target="_blank" rel="noopener noreferrer">more info here</a></p></div><footer class="docusaurus-mt-lg"><div class="row"><div class="col"><a href="https://github.com/Supercolony-net/openbrush-contracts/tree/main/docs/docs/evm-wasm-smart-contracts.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/deployment"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Deploy</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#evm" class="table-of-contents__link">EVM</a><ul><li><a href="#background" class="table-of-contents__link">Background</a></li><li><a href="#bytecode" class="table-of-contents__link">Bytecode</a></li><li><a href="#gas-model" class="table-of-contents__link">Gas model</a></li><li><a href="#evm-process" class="table-of-contents__link">Evm process</a></li></ul></li><li><a href="#substrate-contract-pallet" class="table-of-contents__link">Substrate Contract-Pallet</a><ul><li><a href="#intro" class="table-of-contents__link">Intro</a></li><li><a href="#wasm-interpreter" class="table-of-contents__link">WASM interpreter</a></li><li><a href="#storage-rent--gas" class="table-of-contents__link">Storage rent &amp; Gas</a></li><li><a href="#contract-code--instance-are-decoupled" class="table-of-contents__link">Contract code &amp; instance are decoupled</a></li></ul></li><li><a href="#evm-vs-contract-pallet" class="table-of-contents__link">EVM vs contract-pallet</a></li><li><a href="#comparing-wasm-smart-contracts-to-evm-smart-contracts" class="table-of-contents__link">Comparing WASM Smart contracts to EVM smart contracts</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 OpenBrush, Supercolony.net.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.f123e9f3.js"></script>
<script src="/assets/js/main.4e627a49.js"></script>
</body>
</html>